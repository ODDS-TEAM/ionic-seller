<ion-header>
  <ion-toolbar style="padding-top: 14px;"> </ion-toolbar>
  <ion-toolbar style="padding-bottom: 14px;">
    <ion-text
      color="darkgray"
      class="header-title ion-margin-start ion-margin-bottom"
      >Activity</ion-text
    >
  </ion-toolbar>
</ion-header>

<ion-content style="z-index: 1; background-color: #f3f3f3;" color="whitegray">
  <ion-refresher
    style="background-color: #f3f3f3; --background: #f3f3f3;"
    slot="fixed"
    (ionRefresh)="getActivityList($event)"
  >
    <ion-refresher-content
      style="color: #808080; background-color: #f3f3f3; --background: #f3f3f3; z-index: 20;"
      pullFactor="0.5"
      pullMin="100"
      pullMax="100"
      pullingIcon="null"
      refreshingSpinner="circles"
      refreshingText="Refreshing"
    >
    </ion-refresher-content>
  </ion-refresher>
  <ion-toolbar
    class="ion-text-center"
    color="whitegray"
    *ngIf="activityList.today.length == 0 && activityList.tomorrow.length == 0"
  >
    <ion-text color="darkgray"
      >{{ isLoading ? 'Loading...' : 'No order now' }}</ion-text
    >
  </ion-toolbar>
  <ion-list *ngIf="activityList.today.length != 0" class="ion-no-margin">
    <ion-list-header>
      <ion-text class="list-header" color="gprimary">Today</ion-text>
    </ion-list-header>

    <ion-item
      *ngFor="let order of activityList.today; let i=index"
      (click)="openUpdateModal(i, true)"
      style="margin-bottom: 8px;"
      class="ion-no-padding"
    >
      <ion-grid>
        <ion-row class="ion-align-items-center">
          <ion-col
            size="2"
            class="ion-align-items-center ion-justify-content-center"
            style="height: 100%; padding-left: 12px;"
          >
            <ion-avatar class="ion-align-self-center" style="margin: auto;">
              <ion-img [src]="order.customerImageUrl"></ion-img>
            </ion-avatar>
          </ion-col>
          <ion-col
            size="7"
            class="ion-padding-start ion-padding-end"
            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
          >
            <ion-text color="darkgray" style="font-weight: bold;">
              {{ order.customerName }}
            </ion-text>
            <br />
            <ion-text color="darkgray">
              {{ calcNumberOfFood(order.items) }} รายการ
            </ion-text>
            <br />
            <ion-text
              color="darkgray"
              style="width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
            >
              {{ joinFoodName(order.items) }}
            </ion-text>
          </ion-col>
          <ion-col size="3" class="ion-text-center">
            <ion-text
              color="gprimary"
              style="font-weight: 500; font-size: 20pt;"
              >{{ order.queue }}</ion-text
            >
            <br />
            <ion-text
              class="status-text"
              *ngIf="order.state === 'cf'"
              color="brownred"
            >
              Cooking
            </ion-text>
            <ion-text
              class="status-text"
              *ngIf="order.state === 'cd'"
              color="successgreen"
            >
              Cooking done
            </ion-text>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>
  </ion-list>

  <ion-list *ngIf="activityList.tomorrow.length != 0" class="ion-no-margin">
    <ion-list-header>
      <ion-text class="list-header" color="gprimary">Today</ion-text>
    </ion-list-header>

    <ion-item
      *ngFor="let order of activityList.tomorrow; let i=index"
      (click)="openUpdateModal(i, true)"
      style="margin-bottom: 8px;"
      class="ion-no-padding"
    >
      <ion-grid>
        <ion-row class="ion-align-items-center">
          <ion-col
            size="2"
            class="ion-align-items-center ion-justify-content-center"
            style="height: 100%; padding-left: 12px;"
          >
            <ion-avatar class="ion-align-self-center" style="margin: auto;">
              <ion-img [src]="order.customerImageUrl"></ion-img>
            </ion-avatar>
          </ion-col>
          <ion-col
            size="8"
            class="ion-padding-start ion-padding-end"
            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
          >
            <ion-text color="darkgray" style="font-weight: bold;">
              {{ order.customerName }}
            </ion-text>
            <br />
            <ion-text color="darkgray">
              {{ calcNumberOfFood(order.items) }} รายการ
            </ion-text>
            <br />
            <ion-text
              color="darkgray"
              style="width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
            >
              {{ joinFoodName(order.items) }}
            </ion-text>
          </ion-col>
          <ion-col size="2" class="ion-text-center">
            <ion-text
              color="gprimary"
              style="font-weight: 500; font-size: 20pt;"
              >{{ order.queue }}</ion-text
            >
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>
  </ion-list>
</ion-content>

<ion-footer no-border color="whitegray">
  <ion-toolbar class="ion-text-center" color="whitegray">
    <ion-button style="height: 32px;" color="lightgray" shape="round">
      View history
    </ion-button>
  </ion-toolbar>
</ion-footer>
