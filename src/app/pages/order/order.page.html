<ion-header>
  <ion-toolbar style="padding-top: 14px;">
    <ion-icon
      color="lightgray"
      class="header-icon ion-margin-end"
      slot="end"
      name="md-contact"
    ></ion-icon>
  </ion-toolbar>
  <ion-toolbar style="padding-bottom: 14px;">
    <ion-text
      color="darkgray"
      class="header-title ion-margin-start ion-margin-bottom"
      >Order</ion-text
    >
  </ion-toolbar>
</ion-header>

<ion-content style="z-index: 1; background-color: #f3f3f3;" color="whitegray">
  <ion-refresher
    style="background-color: #f3f3f3; --background: #f3f3f3;"
    slot="fixed"
    (ionRefresh)="getOrderList($event)"
  >
    <ion-refresher-content
      style="color: #808080; background-color: #f3f3f3; --background: #f3f3f3; z-index: 20;"
      pullFactor="0.5"
      pullMin="100"
      pullMax="100"
      pullingIcon="arrow-dropdown"
      pullingText="Pull to refresh"
      refreshingSpinner="circles"
      refreshingText="Refreshing..."
    >
    </ion-refresher-content>
  </ion-refresher>
  <ion-toolbar
    class="ion-text-center"
    color="whitegray"
    *ngIf="orderList.today.length == 0 && orderList.tomorrow.length == 0"
  >
    <ion-text color="darkgray"
      >{{ isLoading ? 'Loading...' : 'No order now' }}</ion-text
    >
  </ion-toolbar>
  <ion-list
    *ngIf="orderList.today && orderList.today.length != 0"
    class="ion-no-margin"
  >
    <ion-list-header>
      <ion-text class="list-header" color="gprimary">Today</ion-text>
    </ion-list-header>

    <ion-item
      *ngFor="let order of orderList.today; let i=index"
      (click)="openConfirmationModal(i, true)"
      style="margin-bottom: 8px;"
      class="ion-no-padding"
    >
      <ion-grid>
        <ion-row class="ion-align-items-center">
          <ion-col
            class="ion-no-padding ion-justify-content-center"
            style="max-width: 20% !important; height: 100%;"
          >
            <ion-avatar class="ion-align-self-center" style="margin: auto;">
              <ion-img [src]="order.customerImageUrl"></ion-img>
            </ion-avatar>
          </ion-col>
          <ion-col
            style="width: 70%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
          >
            <ion-text color="darkgray" style="font-weight: bold;">
              {{ order.customerName }}
            </ion-text>
            <br />
            <ion-text color="darkgray">
              {{ calcNumberOfFood(order.items) }} รายการ
            </ion-text>
            <br />
            <ion-text color="darkgray" style="width: 100%;">
              {{ joinFoodName(order.items) }}
            </ion-text>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>
  </ion-list>

  <ion-list *ngIf="orderList.tomorrow && orderList.tomorrow.length != 0">
    <ion-list-header>
      <ion-text class="list-header" color="gprimary">Tomorrow</ion-text>
    </ion-list-header>

    <ion-item
      *ngFor="let order of orderList.tomorrow; let i=index"
      (click)="openConfirmationModal(i, false)"
      style="margin-bottom: 8px;"
      class="ion-no-padding"
    >
      <ion-grid>
        <ion-row class="ion-align-items-center">
          <ion-col
            class="ion-no-padding ion-justify-content-center"
            style="max-width: 20% !important; height: 100%;"
          >
            <ion-avatar class="ion-align-self-center" style="margin: auto;">
              <ion-img [src]="order.customerImageUrl"></ion-img>
            </ion-avatar>
          </ion-col>
          <ion-col style="width: 70%;">
            <ion-text color="darkgray" style="font-weight: bold;">
              {{ order.customerName }}
            </ion-text>
            <br />
            <ion-text color="darkgray">
              {{ calcNumberOfFood(order.items) }} รายการ
            </ion-text>
            <br />
            <ion-text
              color="darkgray"
              style="width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
            >
              {{ joinFoodName(order.items) }}
            </ion-text>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>
  </ion-list>
</ion-content>
